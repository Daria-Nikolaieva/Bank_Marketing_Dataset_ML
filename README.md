# Аналіз та прогнозування підписки на депозит

## Опис задачі
Мета проєкту – побудувати модель, яка передбачає, чи клієнт банку підпише депозит. Використано набір даних про демографічні характеристики клієнтів, інформацію про попередні контакти та макроекономічні показники.

## Що було зроблено
1. **Підготовка даних**
   - Видалено ознаку `duration`, щоб уникнути "витоку" інформації.  
   - Категоріальні ознаки оброблено за допомогою one-hot або залишено у форматі категорій для LightGBM.  
   - Розділення на навчальну, валідаційну та тестову вибірки.
     
2. **EDA (Exploratory Data Analysis)**
   - Перевірено розподіли числових ознак, частоти категорійних ознак.  
   - Виявлено пропущені або рідкісні категорії, які можуть впливати на точність моделі.  
   - Візуалізовано важливі взаємозв’язки та аномалії у даних, що допомогло спланувати подальший feature engineering.  

3. **Створення нових ознак (feature engineering)**
   - Перетворення місяців і днів тижня у синус/косинус для збереження циклічності.  
   - Додані взаємодії числових ознак.  
   - Використано target encoding для деяких категоріальних ознак.

4. **Побудова моделей**
   - **Лінійна модель (Logistic Regression)** – базова перевірка.  
   - **Дерева рішень (Decision Tree)** – для порівняння і відбору важливих ознак.  
   - **K-Nearest Neighbors (KNN)** – додатково для перевірки моделей без навчання дерев.
   - **LightGBM та XGBoost** – фінальні моделі, підібрані за допомогою крос-валідації та підбору гіперпараметрів.  

5. **Оцінка моделей**
   - Використано метрику **ROC-AUC**, оскільки класи неспіввідношені, і нас цікавить ймовірність правильного передбачення.  
   - Перевірено важливість ознак через LightGBM та SHAP для кращого розуміння моделі.

6. **Аналіз помилок**
   - Проаналізовані записи, де модель помиляється.  
   - Виявлено, що найбільша частка помилок припадає на певні категорії (наприклад, “unknown” або маловідомі job).  
   - Висновок: можна покращити модель через додаткові ознаки або більш точну обробку рідкісних категорій. Або використавши інші способи кодування

## Результати експериментів

| Модель            | ROC-AUC train | ROC-AUC val | Коментар |
|------------------|---------------|------------|----------|
| Logistic Regression | 0.9418         | 0.9413      | базова модель |
| Decision Tree       | 0.9433         | 0.9376      | добре навчається, трохи overfitting |
| kNN      | 1.0         | 0.8084      | дуже сильно оверфітить |
| LightGBM (фінальна) | 0.9740         | 0.9510      | найкращий баланс |
| XGBoost            | 0.9615         | 	0.9482      | теж дуже добре, трохи нижче LightGBM |

## Висновки
- Найкращою моделлю виявилась **LightGBM**, вона забезпечує найвищий ROC-AUC на валідаційній вибірці.  
- Найважливіші ознаки: `euribor3m`, `age`, `campaign`, макроекономічні показники.  
- Аналіз помилок показав, що модель гірше працює для рідкісних категорій, тому можна покращити результати через:
  - додатковий feature engineering для рідкісних категорій,  
  - балансування класів,  
  - створення нових взаємодій між ознаками.
